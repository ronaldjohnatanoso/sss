D:\thesis\nanoGPT\model.py:64: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at C:\cb\pytorch_1000000000000\work\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:455.)
  y = torch.nn.functional.scaled_dot_product_attention(q, k, v, attn_mask=None, dropout_p=self.dropout if self.training else 0, is_causal=True)
step 0: train loss 10.9817, val loss 10.9793
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 3.98 GB
  Allocated: 1.32 GB
  Free: 0.32 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 4.59 GB
  Allocated: 1.32 GB
  Free: -0.30 GB
  Estimated memory for this iteration: 20.58 GB
iter 0: loss 10.9592, time 47350.30ms, mfu -100.00%
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 2.31 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 20.58 GB
Traceback (most recent call last):
  File "D:\thesis\nanoGPT\train.py", line 313, in <module>
    cuda.synchronize()
  File "C:\Users\Ronald\miniconda3\envs\torchenv\lib\site-packages\torch\cuda\__init__.py", line 792, in synchronize
    return torch._C._cuda_synchronize()
KeyboardInterrupt