D:\thesis\nanoGPT\model.py:64: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at C:\cb\pytorch_1000000000000\work\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:455.)
  y = torch.nn.functional.scaled_dot_product_attention(q, k, v, attn_mask=None, dropout_p=self.dropout if self.training else 0, is_causal=True)
step 0: train loss 10.9817, val loss 10.9793
GPU Memory before iteration 0:
  Total: 4.29 GB
  Reserved: 2.74 GB
  Allocated: 0.51 GB
  Free: 1.56 GB
  Estimated memory for this iteration: 15.56 GB
iter 0: loss 10.9965, time 43207.71ms, mfu -100.00%
Time stamp: 2024-07-06 11:32:14, Time since last checkpoint: 0:00:43
GPU Memory before iteration 10:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 10: loss 9.9867, time 41801.64ms, mfu 0.45%
Time stamp: 2024-07-06 11:38:28, Time since last checkpoint: 0:06:14
GPU Memory before iteration 20:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 20: loss 9.1433, time 42042.84ms, mfu 0.45%
Time stamp: 2024-07-06 11:44:56, Time since last checkpoint: 0:06:27
GPU Memory before iteration 30:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 30: loss 8.6596, time 41851.50ms, mfu 0.45%
Time stamp: 2024-07-06 11:51:18, Time since last checkpoint: 0:06:22
GPU Memory before iteration 40:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 40: loss 8.4313, time 48405.77ms, mfu 0.44%
Time stamp: 2024-07-06 11:58:15, Time since last checkpoint: 0:06:57
GPU Memory before iteration 50:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 50: loss 8.3444, time 48430.06ms, mfu 0.44%
Time stamp: 2024-07-06 12:05:35, Time since last checkpoint: 0:07:20
GPU Memory before iteration 60:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 60: loss 8.2227, time 48548.67ms, mfu 0.43%
Time stamp: 2024-07-06 12:12:58, Time since last checkpoint: 0:07:22
GPU Memory before iteration 70:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 70: loss 7.8506, time 48369.75ms, mfu 0.43%
Time stamp: 2024-07-06 12:20:20, Time since last checkpoint: 0:07:21
GPU Memory before iteration 80:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 80: loss 7.5900, time 49508.72ms, mfu 0.42%
Time stamp: 2024-07-06 12:27:52, Time since last checkpoint: 0:07:31
GPU Memory before iteration 90:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 90: loss 7.1659, time 48903.46ms, mfu 0.42%
Time stamp: 2024-07-06 12:35:33, Time since last checkpoint: 0:07:41
GPU Memory before iteration 100:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 100: loss 7.1424, time 49851.51ms, mfu 0.42%
Time stamp: 2024-07-06 12:42:59, Time since last checkpoint: 0:07:26
GPU Memory before iteration 110:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 110: loss 6.5908, time 49024.54ms, mfu 0.41%
Time stamp: 2024-07-06 12:50:31, Time since last checkpoint: 0:07:31
GPU Memory before iteration 120:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 120: loss 6.1615, time 48480.68ms, mfu 0.41%
Time stamp: 2024-07-06 12:57:58, Time since last checkpoint: 0:07:26
GPU Memory before iteration 130:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 130: loss 6.1533, time 48749.34ms, mfu 0.41%
Time stamp: 2024-07-06 13:05:26, Time since last checkpoint: 0:07:28
GPU Memory before iteration 140:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 140: loss 5.7850, time 51451.44ms, mfu 0.40%
Time stamp: 2024-07-06 13:13:17, Time since last checkpoint: 0:07:50
GPU Memory before iteration 150:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 150: loss 5.5333, time 43796.15ms, mfu 0.41%
Time stamp: 2024-07-06 21:20:39, Time since last checkpoint: 8:07:21
GPU Memory before iteration 160:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 160: loss 5.5231, time 49440.83ms, mfu 0.40%
Time stamp: 2024-07-06 21:28:13, Time since last checkpoint: 0:07:34
GPU Memory before iteration 170:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 170: loss 5.2623, time 41584.13ms, mfu 0.41%
Time stamp: 2024-07-06 21:35:30, Time since last checkpoint: 0:07:16
GPU Memory before iteration 180:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 180: loss 4.9979, time 40628.75ms, mfu 0.41%
Time stamp: 2024-07-06 21:42:19, Time since last checkpoint: 0:06:49
GPU Memory before iteration 190:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 190: loss 4.9759, time 43642.47ms, mfu 0.42%
Time stamp: 2024-07-06 21:49:29, Time since last checkpoint: 0:07:10
GPU Memory before iteration 200:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 200: loss 4.8959, time 48398.88ms, mfu 0.41%
Time stamp: 2024-07-06 21:56:52, Time since last checkpoint: 0:07:22
GPU Memory before iteration 210:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 210: loss 4.6012, time 48390.52ms, mfu 0.41%
Time stamp: 2024-07-06 22:04:15, Time since last checkpoint: 0:07:22
GPU Memory before iteration 220:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 220: loss 4.5582, time 38589.73ms, mfu 0.42%
Time stamp: 2024-07-06 22:11:16, Time since last checkpoint: 0:07:01
GPU Memory before iteration 230:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 230: loss 4.6150, time 38450.70ms, mfu 0.43%
Time stamp: 2024-07-06 22:17:14, Time since last checkpoint: 0:05:57
GPU Memory before iteration 240:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 240: loss 4.7207, time 45870.44ms, mfu 0.42%
Time stamp: 2024-07-06 22:24:20, Time since last checkpoint: 0:07:05
GPU Memory before iteration 250:
  Total: 4.29 GB
  Reserved: 5.83 GB
  Allocated: 1.82 GB
  Free: -1.54 GB
  Estimated memory for this iteration: 15.56 GB
iter 250: loss 4.5959, time 45991.09ms, mfu 0.42%
Time stamp: 2024-07-06 22:31:26, Time since last checkpoint: 0:07:06
Traceback (most recent call last):
  File "D:\thesis\nanoGPT\train.py", line 340, in <module>
    scaler.scale(loss).backward()
  File "C:\Users\Ronald\miniconda3\envs\torchenv\lib\site-packages\torch\_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "C:\Users\Ronald\miniconda3\envs\torchenv\lib\site-packages\torch\autograd\__init__.py", line 267, in backward
    _engine_run_backward(
  File "C:\Users\Ronald\miniconda3\envs\torchenv\lib\site-packages\torch\autograd\graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt